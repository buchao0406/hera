(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25f2d318"],{"06c5":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n("fb6a"),n("d3b7"),n("b0c0"),n("a630"),n("3ca3");var a=n("6b75");function o(t,e){if(t){if("string"===typeof t)return Object(a["a"])(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(a["a"])(t,e):void 0}}},"25f0":function(t,e,n){"use strict";var a=n("6eeb"),o=n("825a"),r=n("d039"),i=n("ad6d"),s="toString",c=RegExp.prototype,l=c[s],u=r((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),f=l.name!=s;(u||f)&&a(RegExp.prototype,s,(function(){var t=o(this),e=String(t.source),n=t.flags,a=String(void 0===n&&t instanceof RegExp&&!("flags"in c)?i.call(t):n);return"/"+e+"/"+a}),{unsafe:!0})},"53ca":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function a(t){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}},"64d3":function(t,e,n){"use strict";n("9f5d")},"6b75":function(t,e,n){"use strict";function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}n.d(e,"a",(function(){return a}))},"9f5d":function(t,e,n){},c466:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return r}));var a=n("53ca");n("d3b7"),n("25f0"),n("5319"),n("ac1f"),n("1276");function o(t,e){if(0===arguments.length)return null;var n,o=e||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(a["a"])(t)?n=t:("string"===typeof t&&/^[0-9]+$/.test(t)&&(t=parseInt(t)),"number"===typeof t&&10===t.toString().length&&(t*=1e3),n=new Date(t));var r={y:n.getFullYear(),m:n.getMonth()+1,d:n.getDate(),h:n.getHours(),i:n.getMinutes(),s:n.getSeconds(),a:n.getDay()},i=o.replace(/{(y|m|d|h|i|s|a)+}/g,(function(t,e){var n=r[e];return"a"===e?["日","一","二","三","四","五","六"][n]:(t.length>0&&n<10&&(n="0"+n),n||0)}));return i}var r=function(t){return t.sort((function(t,e){var n=new Date(t),a=new Date(e);return n===a?0:n>a?1:-1}))}},e639:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dashboard-container"},[n("div",[n("a-range-picker",{staticStyle:{"margin-right":"10px"},attrs:{format:"YYYY-MM-DD",placeholder:["日期开始","日期结束"],size:"small"},on:{ok:t.paint,change:t.paint},model:{value:t.moment,callback:function(e){t.moment=e},expression:"moment"}}),n("a-select",{attrs:{size:"small"},on:{change:t.paint},model:{value:t.filter.triggerType,callback:function(e){t.$set(t.filter,"triggerType",e)},expression:"filter.triggerType"}},[n("a-select-option",{attrs:{value:1}},[t._v("自动调度")]),n("a-select-option",{attrs:{value:6}},[t._v("超级恢复")])],1),n("a-select",{staticStyle:{"margin-left":"10px",width:"100px"},attrs:{size:"small"},on:{change:t.paint},model:{value:t.filter.periodType,callback:function(e){t.$set(t.filter,"periodType",e)},expression:"filter.periodType"}},t._l([{value:"hour",label:"小时任务"},{value:"day",label:"天任务"},{value:"month",label:"月任务"},{value:"dependency",label:"依赖任务"},{value:"none",label:"所有任务"}],(function(e,a){return n("a-select-option",{key:a,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1),n("a-select",{staticStyle:{"margin-left":"10px",width:"100px"},attrs:{size:"small","show-search":"","filter-option":t.filterOption},on:{change:t.paint},model:{value:t.filter.userId,callback:function(e){t.$set(t.filter,"userId",e)},expression:"filter.userId"}},t._l(t.users,(function(e){return n("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1),n("a-radio-group",{staticStyle:{"margin-left":"10px"},attrs:{"default-value":"list","button-style":"solid",size:"small"},on:{change:t.changeType},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[n("a-radio-button",{attrs:{value:"list"}},[t._v(" 任务执行情况排行 ")]),n("a-radio-button",{attrs:{value:"track"}},[t._v(" 任务执行过程回放 ")]),n("a-radio-button",{attrs:{value:"gantt",disabled:""}},[t._v(" 任务执行甘特图 ")])],1)],1),n("div",{staticClass:"count-bar"},[t._l(t.statusInfo,(function(e,a,o){return n("div",{key:o,staticClass:"count-item"},[n("span",{staticClass:"title",on:{click:function(e){return t.showDetail(a)}}},[t._v(t._s(t.nameLabel[a]))]),n("span",{staticClass:"value"},[t._v(" "+t._s(e))])])})),n("div",{staticClass:"count-item"},[n("span",{staticClass:"title"},[t._v(t._s(t.nameLabel["SCHEDULE_COUNT"]))]),n("span",{staticClass:"value"},[t._v(" "+t._s(t.scheduleCount))])])],2),"list"===t.type?n("div",{staticClass:"list-container"},t._l(t.jobTopInfo,(function(e,a,o){return n("div",{key:o,staticClass:"list-item"},[n("div",{staticClass:"title"},[t._v(t._s(t.nameLabel[a]))]),n("div",{staticClass:"list"},[n("a-table",{attrs:{size:"small","data-source":e.data.map((function(e){return Object.assign({},e,{value:t.valueFormat[a](e.value)})})),columns:t.columns,locale:{emptyText:" "},pagination:!1},scopedSlots:t._u([{key:"name",fn:function(e){return[n("a",{on:{click:function(n){return t.$router.push({name:"任务开发",params:{jobId:e.jobId}})}}},[t._v(t._s(e.name)+"("+t._s(e.jobId)+")")])]}},{key:"value",fn:function(e){return[n("a",{on:{click:function(n){return t.showDetail(e)}}},[t._v(t._s(e.value))])]}}],null,!0)})],1)])})),0):n("job-track-graph",{ref:"jobTrackGraphRef",staticStyle:{height:"calc(100vh - 215px)"},attrs:{filter:t.filter,jobs:t.jobs}})],1)},o=[],r=n("5530"),i=(n("b680"),n("7db0"),n("b0c0"),n("4de4"),n("498a"),n("5319"),n("ac1f"),n("d3b7"),n("ddb0"),n("159b"),n("b64b"),n("99af"),n("d81d"),n("2c3c")),s=n("bfb4"),c=n("c1df"),l=n.n(c),u=n("cf45"),f=n("884e"),d={SUCCESS:"成功",WAIT:"等待",RECOVER_READY:"超级恢复准备",FAILED:"失败",RUNNING:"运行中",RETRY_WAIT:"重试等待",SCHEDULE_COUNT:"调度次数",wait_time:"等待时间",run_spend:"运行时间",delay_spend:"延迟时间",retry_count:"重试次数"},p={wait_time:function(t){return Object(u["b"])(t)},run_spend:function(t){return Object(u["b"])(t)},delay_spend:function(t){return Object(u["b"])(t)},retry_count:function(t){return"".concat(t.toFixed(1),"次")}},b=[{title:"序号",key:"index",customRender:function(t,e,n){return"".concat(n+1)}},{title:"名称",key:"name",scopedSlots:{customRender:"name"}},{title:"值",key:"value",scopedSlots:{customRender:"value"}}],m={data:function(){return{columns:b,nameLabel:d,valueFormat:p,moment:[],filter:{userId:null,periodType:"none",triggerType:1,dateFrom:0,dateTo:0,jobId:null},statusInfo:{},scheduleCount:0,jobTopInfo:{},users:[],type:"list"}},components:{JobTrackGraph:f["a"]},created:function(){var t=this;Object(s["d"])().then((function(e){t.users=e;var n=t.users.find((function(e){return e.name===t.getUser()}));t.filter.userId=null===n||void 0===n?void 0:n.id}));var e=new Date,n=new Date;n.setTime(e.getTime()-864e5);var a="YYYY-MM-DD";this.moment[0]=l()(n.toLocaleDateString(),a),this.moment[1]=l()(e.toLocaleDateString(),a),this.paint()},methods:{filterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0},changeType:function(){var t=this;"track"===this.type&&this.$nextTick((function(){t.$refs.jobTrackGraphRef.draw()}))},getUser:function(){return(localStorage.getItem("ssoName")||"").replace("用户:","").trim()},showDetail:function(t){"string"==typeof t?Object(i["a"])(Object(r["a"])(Object(r["a"])({},this.filter),{},{status:t})).then((function(t){console.log(t)})):console.log(t.values)},paint:function(){var t=this;this.jobTopInfo={},this.scheduleCount=0,this.statusInfo={},this.filter.dateFrom=1e3*this.moment[0].unix(),this.filter.dateTo=1e3*this.moment[1].unix();var e=this.filter;Object(i["d"])(e).then((function(e){return t.statusInfo=e})),Object(i["e"])(e).then((function(e){var n;t.scheduleCount=(null===(n=e.schedule_count)||void 0===n?void 0:n.value)||0,delete e.schedule_count,t.jobTopInfo=e;var a=[];Object.keys(e).forEach((function(t){a=a.concat(e[t].data.map((function(t){return{jobId:t.jobId,name:"".concat(t.name,"[").concat(t.jobId,"]")}})))})),t.jobs=Object(u["a"])(a,"jobId")}))}}},v=m,h=(n("64d3"),n("2877")),y=Object(h["a"])(v,a,o,!1,null,"3f82f6f7",null);e["default"]=y.exports}}]);