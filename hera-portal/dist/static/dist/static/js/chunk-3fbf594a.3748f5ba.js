(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3fbf594a"],{"0b448":function(t,e,o){"use strict";o("9c6f")},2845:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=this,o=e.$createElement,n=e._self._c||o;return n("div",{staticClass:"develop-container"},[n("div",{staticStyle:{"padding-left":"30px","font-family":"'Microsoft YaHei'","font-size":"18px","font-weight":"bold"}},[e._v(" 任务id: "+e._s(e.query.jobId)+" 执行机器:"+e._s(e.item.executeHost)+" 开始时间:"+e._s(e.item.startTime)+" 结束时间:"+e._s(e.item.endTime)+" 任务状态:"+e._s(e.item.status)+" 已加载日志:"+e._s(Math.ceil(e.position/1024))+" kb ")]),e._m(0),n("div",{staticStyle:{"padding-left":"30px"}},[n("div",{staticStyle:{position:"center"}},[this.autoRefresh?e._e():n("a-button",{attrs:{type:"primary"},on:{click:function(){t.scrollToTop()}}},[e._v(" 日志顶部 ")]),this.autoRefresh?e._e():n("a-button",{attrs:{type:"primary"},on:{click:function(){t.scrollToBottom()}}},[e._v(" 日志底部 ")]),e.autoRefresh?n("a-button",{attrs:{type:"primary"},on:{click:function(){t.autoRefresh=!1}}},[e._v(" 停止滚动 ")]):n("a-button",{attrs:{type:"primary"},on:{click:function(){t.end?(t.$message.success("日志更新已完成"),t.scrollToBottom()):(t.autoRefresh=!0,t.intervalLog())}}},[e._v(" 自动滚动 ")])],1)])])},r=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"clusterize-scroll",attrs:{id:"scrollArea"}},[o("div",{staticClass:"clusterize-content",attrs:{id:"contentArea"}},[o("div",{staticClass:"clusterize-no-data"},[t._v("Loading data…")])])])}],i=(o("1276"),o("ac1f"),o("1215")),s=o("ba51"),l=o.n(s),a={data:function(){return{query:{},position:0,end:!1,item:[],autoRefresh:!0,timeoutTask:null,clusterize:null}},watch:{autoRefresh:function(t){!1===t&&clearTimeout(this.timeoutTask)}},mounted:function(){this.query=this.$route.query,this.intervalLog();var t=[];this.clusterize=new l.a({rows:t,scrollId:"scrollArea",contentId:"contentArea",rows_in_block:40})},methods:{scrollToTop:function(){var t=this;this.$nextTick((function(){var e=t.$el.querySelector("#scrollArea");e.scrollTop=0}))},scrollToBottom:function(){var t=this;this.$nextTick((function(){var e=t.$el.querySelector("#scrollArea");e.scrollTop=e.scrollHeight}))},intervalLog:function(){var t=this;Object(i["p"])(this.query.id,this.query.jobId,this.position,!1).then((function(e){0===t.position&&t.clusterize.update(e.headLog.split("<br>")),t.position=e.position,t.clusterize.append(e.log.split("<br>")),t.end=e.end,t.item=e.history,t.end&&(t.autoRefresh=!1),t.clusterize.refresh(!0),t.scrollToBottom(),t.autoRefresh&&(t.timeoutTask=setTimeout((function(){t.intervalLog()}),5e3))})).catch((function(){t.$message.error("异常停止滚动,请重试"),t.autoRefresh=!1}))}}},c=a,h=(o("0b448"),o("2877")),u=Object(h["a"])(c,n,r,!1,null,null,null);e["default"]=u.exports},"9c6f":function(t,e,o){},ba51:function(t,e,o){(function(e,o){t.exports=o()})(0,(function(){"use strict";var t=function(){for(var t=3,e=document.createElement("b"),o=e.all||[];e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i><![endif]--\x3e",o[0];);return t>4?t:document.documentMode}(),e=navigator.platform.toLowerCase().indexOf("mac")+1,o=function(t){if(!(this instanceof o))return new o(t);var s=this,l={rows_in_block:50,blocks_in_cluster:4,tag:null,show_no_data_row:!0,no_data_class:"clusterize-no-data",no_data_text:"No data",keep_parity:!0,callbacks:{}};s.options={};for(var a,c=["rows_in_block","blocks_in_cluster","show_no_data_row","no_data_class","no_data_text","keep_parity","tag","callbacks"],h=0;a=c[h];h++)s.options[a]="undefined"!=typeof t[a]&&null!=t[a]?t[a]:l[a];var u,p=["scroll","content"];for(h=0;u=p[h];h++)if(s[u+"_elem"]=t[u+"Id"]?document.getElementById(t[u+"Id"]):t[u+"Elem"],!s[u+"_elem"])throw new Error("Error! Could not find "+u+" element");s.content_elem.hasAttribute("tabindex")||s.content_elem.setAttribute("tabindex",0);var f=i(t.rows)?t.rows:s.fetchMarkup(),_={},d=s.scroll_elem.scrollTop;s.insertToDOM(f,_),s.scroll_elem.scrollTop=d;var m=!1,g=0,v=!1,b=function(){e&&(v||(s.content_elem.style.pointerEvents="none"),v=!0,clearTimeout(g),g=setTimeout((function(){s.content_elem.style.pointerEvents="auto",v=!1}),50)),m!=(m=s.getClusterNum())&&s.insertToDOM(f,_),s.options.callbacks.scrollingProgress&&s.options.callbacks.scrollingProgress(s.getScrollProgress())},w=0,T=function(){clearTimeout(w),w=setTimeout(s.refresh,100)};n("scroll",s.scroll_elem,b),n("resize",window,T),s.destroy=function(t){r("scroll",s.scroll_elem,b),r("resize",window,T),s.html((t?s.generateEmptyRow():f).join(""))},s.refresh=function(t){(s.getRowsHeight(f)||t)&&s.update(f)},s.update=function(t){f=i(t)?t:[];var e=s.scroll_elem.scrollTop;f.length*s.options.item_height<e&&(s.scroll_elem.scrollTop=0,m=0),s.insertToDOM(f,_),s.scroll_elem.scrollTop=e},s.clear=function(){s.update([])},s.getRowsAmount=function(){return f.length},s.getScrollProgress=function(){return this.options.scroll_top/(f.length*this.options.item_height)*100||0};var y=function(t,e){var o=i(e)?e:[];o.length&&(f="append"==t?f.concat(o):o.concat(f),s.insertToDOM(f,_))};s.append=function(t){y("append",t)},s.prepend=function(t){y("prepend",t)}};function n(t,e,o){return e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o)}function r(t,e,o){return e.removeEventListener?e.removeEventListener(t,o,!1):e.detachEvent("on"+t,o)}function i(t){return"[object Array]"===Object.prototype.toString.call(t)}function s(t,e){return window.getComputedStyle?window.getComputedStyle(e)[t]:e.currentStyle[t]}return o.prototype={constructor:o,fetchMarkup:function(){var t=[],e=this.getChildNodes(this.content_elem);while(e.length)t.push(e.shift().outerHTML);return t},exploreEnvironment:function(e,o){var n=this.options;n.content_tag=this.content_elem.tagName.toLowerCase(),e.length&&(t&&t<=9&&!n.tag&&(n.tag=e[0].match(/<([^>\s/]*)/)[1].toLowerCase()),this.content_elem.children.length<=1&&(o.data=this.html(e[0]+e[0]+e[0])),n.tag||(n.tag=this.content_elem.children[0].tagName.toLowerCase()),this.getRowsHeight(e))},getRowsHeight:function(t){var e=this.options,o=e.item_height;if(e.cluster_height=0,t.length){var n=this.content_elem.children;if(n.length){var r=n[Math.floor(n.length/2)];if(e.item_height=r.offsetHeight,"tr"==e.tag&&"collapse"!=s("borderCollapse",this.content_elem)&&(e.item_height+=parseInt(s("borderSpacing",this.content_elem),10)||0),"tr"!=e.tag){var i=parseInt(s("marginTop",r),10)||0,l=parseInt(s("marginBottom",r),10)||0;e.item_height+=Math.max(i,l)}return e.block_height=e.item_height*e.rows_in_block,e.rows_in_cluster=e.blocks_in_cluster*e.rows_in_block,e.cluster_height=e.blocks_in_cluster*e.block_height,o!=e.item_height}}},getClusterNum:function(){return this.options.scroll_top=this.scroll_elem.scrollTop,Math.floor(this.options.scroll_top/(this.options.cluster_height-this.options.block_height))||0},generateEmptyRow:function(){var t=this.options;if(!t.tag||!t.show_no_data_row)return[];var e,o=document.createElement(t.tag),n=document.createTextNode(t.no_data_text);return o.className=t.no_data_class,"tr"==t.tag&&(e=document.createElement("td"),e.colSpan=100,e.appendChild(n)),o.appendChild(e||n),[o.outerHTML]},generate:function(t,e){var o=this.options,n=t.length;if(n<o.rows_in_block)return{top_offset:0,bottom_offset:0,rows_above:0,rows:n?t:this.generateEmptyRow()};var r=Math.max((o.rows_in_cluster-o.rows_in_block)*e,0),i=r+o.rows_in_cluster,s=Math.max(r*o.item_height,0),l=Math.max((n-i)*o.item_height,0),a=[],c=r;s<1&&c++;for(var h=r;h<i;h++)t[h]&&a.push(t[h]);return{top_offset:s,bottom_offset:l,rows_above:c,rows:a}},renderExtraTag:function(t,e){var o=document.createElement(this.options.tag),n="clusterize-";return o.className=[n+"extra-row",n+t].join(" "),e&&(o.style.height=e+"px"),o.outerHTML},insertToDOM:function(t,e){this.options.cluster_height||this.exploreEnvironment(t,e);var o=this.generate(t,this.getClusterNum()),n=o.rows.join(""),r=this.checkChanges("data",n,e),i=this.checkChanges("top",o.top_offset,e),s=this.checkChanges("bottom",o.bottom_offset,e),l=this.options.callbacks,a=[];r||i?(o.top_offset&&(this.options.keep_parity&&a.push(this.renderExtraTag("keep-parity")),a.push(this.renderExtraTag("top-space",o.top_offset))),a.push(n),o.bottom_offset&&a.push(this.renderExtraTag("bottom-space",o.bottom_offset)),l.clusterWillChange&&l.clusterWillChange(),this.html(a.join("")),"ol"==this.options.content_tag&&this.content_elem.setAttribute("start",o.rows_above),this.content_elem.style["counter-increment"]="clusterize-counter "+(o.rows_above-1),l.clusterChanged&&l.clusterChanged()):s&&(this.content_elem.lastChild.style.height=o.bottom_offset+"px")},html:function(e){var o=this.content_elem;if(t&&t<=9&&"tr"==this.options.tag){var n,r=document.createElement("div");r.innerHTML="<table><tbody>"+e+"</tbody></table>";while(n=o.lastChild)o.removeChild(n);var i=this.getChildNodes(r.firstChild.firstChild);while(i.length)o.appendChild(i.shift())}else o.innerHTML=e},getChildNodes:function(t){for(var e=t.children,o=[],n=0,r=e.length;n<r;n++)o.push(e[n]);return o},checkChanges:function(t,e,o){var n=e!=o[t];return o[t]=e,n}},o}))}}]);